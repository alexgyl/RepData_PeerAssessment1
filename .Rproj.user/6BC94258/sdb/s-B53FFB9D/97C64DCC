{
    "contents" : "---\ntitle: \"PA1_template\"\noutput: html_document\n---\n\nThis is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.\n\nWhen you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:\n\nYou can also embed plots, for example:\n\n```{r, echo=FALSE}\nplot(cars)\n```\n\n\n# Reproducible Research Course Project 1\n### Required libraries\n```{r}\nlibrary(lubridate)\nlibrary(dplyr)\nlibrary(chron)\nlibrary(ggplot2)\n```\n## Code for reading in the dataset and/or processing the data\n```{r}\nfulldata = read.csv(\"activity.csv\",header = TRUE,sep = \",\",na.strings = \"NA\")\nfulldata = tbl_df(fulldata)\n```\n##### Changing the date variable to appropriate format\n```{r}\nfulldata$date = ymd(fulldata$date)\n```\n## Initial analysis of data\n##### Calculating total number of steps taken each day\n```{r}\nsum_data = fulldata %>% \n  select(steps,date) %>% \n  group_by(date) %>% \n  summarize(totalsteps = sum(steps,na.rm=TRUE))\n```\n##### Histogram of the total number of steps taken each day\n###### *X-label is the total no. of steps per day, Y-label is the no. of counts of those occurences* \n```{r}\nhist(sum_data$totalsteps,\n     xlab = \"Total Steps per day\",\n     breaks = 50,col = \"red\",\n     main = \"Histogram of the Total Number of Steps per day\")\n```\n![](/path/to/hist orignal data.png)\n##### Mean and median number of steps taken each day\n```{r}\nmeanSteps = mean(sum_data$totalsteps,na.rm = TRUE)\nmedianSteps = median(sum_data$totalsteps,na.rm = TRUE)\n```\nMean no. of steps is given by **9354** and median no. of steps is given by **10395**\n\n##### Time series plot of the average number of steps taken\n```{r}\navg_data = fulldata %>% \n  select(steps,interval) %>% \n  group_by(interval) %>% \n  summarize(avgsteps = mean(steps,na.rm=TRUE))\n\nwith(avg_data,\n     plot(avgsteps~interval,\n          type = \"l\",\n          ylab = \"Average No. of Steps\",\n          xlab = \"Time Interval\",\n          main = \"Average number of steps per time interval\"))\n```\n##### The 5-minute interval that, on average, contains the maximum number of steps\n```{r}\nmaxInterval = avg_data$interval[max(avg_data$avgsteps)]\n```\nInterval with the maximum average number of steps is given by **1705-1710**\n\n## Imputing missing data\n##### Calculating total no. of NAs in data set\n```{r}\nnumNA = sum(is.na(fulldata$steps))\n```\nThere are a total of **2304** missing values\n##### To impute missing data, we will use the **mean** for the relavant 5min interval for the day through a custom function that assigns the correct value if a *NA* is seen\n```{r}\nnewdata = fulldata\nimputeData = function(x1,x2){\n  if(is.na(x1)){\n    x1 = avg_data[avg_data[,1] == x2,2]\n  }\n  else\n    x1 = x1\n}\nt1 = as.vector(unlist(mapply(imputeData,newdata$steps,newdata$interval,SIMPLIFY = TRUE)))\n```\n##### Overwriting the original data with the new imputed data\n```{r}\nnewdata$steps = t1\n```\n##### Calculating total number of steps taken each day\n```{r}\nsum_data_new = newdata %>% \n  select(steps,date) %>% \n  group_by(date) %>% \n  summarize(totalsteps = sum(steps))\n```\n##### Histogram of the total number of steps taken each day\n```{r}\nhist(sum_data_new$totalsteps,\n     xlab = \"Total Steps per day\",\n     breaks = 50,col = \"red\",\n     main = \"Histogram of the Total Number of Steps per day\")\n```\n## Mean and median number of steps taken each day after imputing values\n```{r}\nmeanStepsNew = mean(sum_data_new$totalsteps)\nmedianStepsNew = median(sum_data_new$totalsteps)\n```\nThe new mean number of steps taken each day is now **10766** while the median number of steps is **10395**\nThe values for both mean and median have changed. Mean has changed more drastically than median.\nIn this instance, imputing values have raised the overall mean of the data set. This is largely due to an inherent skew in the data set.\nBy imputing mean values, we have increased the height of the histogram about the mean.\n##### Creating factor variable for weekday/weekend\n```{r}\nnewdata$weekday = is.weekend(newdata$date)\nnewdata$weekday = factor(ifelse(newdata$weekday,\"weekend\",\"weekday\"))\n```\n##### Summarizing data across 5-minute interval and weekday/weekend\n```{r}\nsum_data_wk = newdata %>% \n  select(steps,interval,weekday) %>% \n  group_by(interval,weekday) %>% \n  summarize(meansteps = mean(steps))\n```\n## Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends\n```{r}\nggplot(data = sum_data_wk, aes(x = interval,y = meansteps)) +\n  geom_line() +\n  facet_grid(weekday~.) + \n  xlab(\"5-minute Intervals\") +\n  ylab(\"Average No. of Steps\")\n```\nIt seems like for **weekdays**, there is much higher activity in the *earlier* part of the day. However, the *average* activity in the **afternoon** is lower as compared to the *weekends*.\n\n\n\n",
    "created" : 1454851451166.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1136751991",
    "id" : "97C64DCC",
    "lastKnownWriteTime" : 1454854134,
    "path" : "G:/John Hopkins Data Science Specialization Coursera/Reproducible Research/Course Project 1/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "type" : "r_markdown"
}