{
    "contents" : "---\ntitle: \"PA1_template\"\noutput: html_document\n---\n\nThis is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.\n\nWhen you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:\n\nYou can also embed plots, for example:\n\n```{r, echo=FALSE}\nplot(cars)\n```\n\n\n# Reproducible Research Course Project 1\n### Required libraries\n```{r}\nlibrary(lubridate)\nlibrary(dplyr)\nlibrary(chron)\nlibrary(ggplot2)\n```\n## Code for reading in the dataset and/or processing the data\n```{r}\nfulldata = read.csv(\"activity.csv\",header = TRUE,sep = \",\",na.strings = \"NA\")\nfulldata = tbl_df(fulldata)\n```\n### Changing the date variable to appropriate format\n```{r}\nfulldata$date = ymd(fulldata$date)\n```\n## Initial analysis of data\n### Calculating total number of steps taken each day\n```{r}\nsum_data = fulldata %>% select(steps,date) %>% group_by(date) %>% summarize(totalsteps = sum(steps,na.rm=TRUE))\n```\n### Histogram of the total number of steps taken each day\n#### *X-label is the total no. of steps per day, Y-label is the no. of counts of those occurences* \n```{r}\nhist(sum_data$totalsteps,\n     xlab = \"Total Steps per day\",\n     breaks = 50,col = \"red\",\n     main = \"Histogram of the Total Number of Steps per day\")\n```\n### Mean and median number of steps taken each day\n```{r}\nmeanSteps = mean(sum_data$totalsteps,na.rm = TRUE)\nmedianSteps = median(sum_data$totalsteps,na.rm = TRUE)\n```\nMean no. of steps is given by **9354** and median no. of steps is given by **10395**\n\n### Time series plot of the average number of steps taken\n```{r,echo = FALSE}\navg_data = fulldata %>% select(steps,interval) %>% group_by(interval) %>% summarize(avgsteps = mean(steps,na.rm=TRUE))\nwith(avg_data,\n     plot(avgsteps~interval,\n          type = \"l\",\n          ylab = \"Average No. of Steps\",\n          xlab = \"Time Interval\",\n          main = \"Average number of steps per time interval\"))\n```\n## The 5-minute interval that, on average, contains the maximum number of steps\nmaxInterval = avg_data$interval[max(avg_data$avgsteps)]\n\n## Code to describe and show a strategy for imputing missing data\n# Calculating total no. of NAs in data set\nnumNA = sum(is.na(fulldata$steps))\n# To impute missing data, we will use the mean for the relavant 5min interval for the day\nnewdata = fulldata\nimputeData = function(x1,x2){\n  if(is.na(x1)){\n    x1 = avg_data[avg_data[,1] == x2,2]\n  }\n  else\n    x1 = x1\n}\n## This applies a custom function to the data and returns the mean of the interval if the original input is NA\nt1 = as.vector(unlist(mapply(imputeData,newdata$steps,newdata$interval,SIMPLIFY = TRUE)))L\n# Overwriting the original data with the new imputed data\nnewdata$steps = t1\n\n## Histogram of the total number of steps taken each day after missing values are imputed\n## Calculating total number of steps taken each day\nsum_data_new = newdata %>% select(steps,date) %>% group_by(date) %>% summarize(totalsteps = sum(steps))\n\n## Histogram of the total number of steps taken each day\nhist(sum_data_new$totalsteps,\n     xlab = \"Total Steps per day\",\n     breaks = 50,col = \"red\",\n     main = \"Histogram of the Total Number of Steps per day\")\n\n## Mean and median number of steps taken each day after imputing values\nmeanStepsNew = mean(sum_data_new$totalsteps)\nmedianStepsNew = median(sum_data_new$totalsteps)\n\n\n## Creating factor variable for weekday/weekend\nnewdata$weekday = is.weekend(newdata$date)\nnewdata$weekday = factor(ifelse(newdata$weekday,\"weekend\",\"weekday\"))\n\n## Summarizing data across 5-minute interval and weekday/weekend\nsum_data_wk = newdata %>% select(steps,interval,weekday) %>% group_by(interval,weekday) %>% summarize(meansteps = mean(steps))\n## Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends\nggplot(data = sum_data_wk, aes(x = interval,y = meansteps)) +\n  geom_line() +\n  facet_grid(weekday~.) + \n  xlab(\"5-minute Intervals\") +\n  ylab(\"Average No. of Steps\")\n\n\n\n\n\nNote that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.\n",
    "created" : 1454851451166.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1296797376",
    "id" : "97C64DCC",
    "lastKnownWriteTime" : 1454852522,
    "path" : "G:/John Hopkins Data Science Specialization Coursera/Reproducible Research/Course Project 1/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "type" : "r_markdown"
}