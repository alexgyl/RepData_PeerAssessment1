{
    "contents" : "## Reproducible Research Course Project 1\nlibrary(lubridate)\nlibrary(dplyr)\nlibrary(chron)\nlibrary(ggplot2)\n## Code for reading in the dataset and/or processing the data\nfulldata = read.csv(\"activity.csv\",header = TRUE,sep = \",\",na.strings = \"NA\")\nfulldata = tbl_df(fulldata)\n# Changing the date variable to appropriate format\nfulldata$date = ymd(fulldata$date)\n\n## Calculating total number of steps taken each day\nsum_data = fulldata %>% select(steps,date) %>% group_by(date) %>% summarize(totalsteps = sum(steps,na.rm=TRUE))\n\n## Histogram of the total number of steps taken each day\nhist(sum_data$totalsteps,\n     xlab = \"Total Steps per day\",\n     breaks = 50,col = \"red\",\n     main = \"Histogram of the Total Number of Steps per day\")\n\n## Mean and median number of steps taken each day\nmeanSteps = mean(sum_data$totalsteps,na.rm = TRUE)\nmedianSteps = median(sum_data$totalsteps,na.rm = TRUE)\n\n## Time series plot of the average number of steps taken\navg_data = fulldata %>% select(steps,interval) %>% group_by(interval) %>% summarize(avgsteps = mean(steps,na.rm=TRUE))\nwith(avg_data,\n     plot(avgsteps~interval,\n          type = \"l\",\n          ylab = \"Average No. of Steps\",\n          xlab = \"Time Interval\",\n          main = \"Average number of steps per time interval\"))\n\n## The 5-minute interval that, on average, contains the maximum number of steps\nmaxInterval = avg_data$interval[max(avg_data$avgsteps)]\n\n## Code to describe and show a strategy for imputing missing data\n# Calculating total no. of NAs in data set\nnumNA = sum(is.na(fulldata$steps))\n# To impute missing data, we will use the mean for the relavant 5min interval for the day\nnewdata = fulldata\nimputeData = function(x1,x2){\n  if(is.na(x1)){\n    x1 = avg_data[avg_data[,1] == x2,2]\n  }\n  else\n    x1 = x1\n}\n## This applies a custom function to the data and returns the mean of the interval if the original input is NA\nt1 = as.vector(unlist(mapply(imputeData,newdata$steps,newdata$interval,SIMPLIFY = TRUE)))L\n# Overwriting the original data with the new imputed data\nnewdata$steps = t1\n\n## Histogram of the total number of steps taken each day after missing values are imputed\n## Calculating total number of steps taken each day\nsum_data_new = newdata %>% select(steps,date) %>% group_by(date) %>% summarize(totalsteps = sum(steps))\n\n## Histogram of the total number of steps taken each day\nhist(sum_data_new$totalsteps,\n     xlab = \"Total Steps per day\",\n     breaks = 50,col = \"red\",\n     main = \"Histogram of the Total Number of Steps per day\")\n\n## Mean and median number of steps taken each day after imputing values\nmeanStepsNew = mean(sum_data_new$totalsteps)\nmedianStepsNew = median(sum_data_new$totalsteps)\n\n\n## Creating factor variable for weekday/weekend\nnewdata$weekday = is.weekend(newdata$date)\nnewdata$weekday = factor(ifelse(newdata$weekday,\"weekend\",\"weekday\"))\n\n## Summarizing data across 5-minute interval and weekday/weekend\nsum_data_wk = newdata %>% select(steps,interval,weekday) %>% group_by(interval,weekday) %>% summarize(meansteps = mean(steps))\n## Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends\nggplot(data = sum_data_wk, aes(x = interval,y = meansteps)) +\n  geom_line() +\n  facet_grid(weekday~.) + \n  xlab(\"5-minute Intervals\") +\n  ylab(\"Average No. of Steps\")\n\n\n\n",
    "created" : 1454843723495.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1623970207",
    "id" : "59BCCF2",
    "lastKnownWriteTime" : 1454851322,
    "path" : "G:/John Hopkins Data Science Specialization Coursera/Reproducible Research/Course Project 1/RepData_PeerAssessment1/PA1.R",
    "project_path" : "PA1.R",
    "properties" : {
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "type" : "r_source"
}